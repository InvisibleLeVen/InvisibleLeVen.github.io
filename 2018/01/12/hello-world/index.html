<!DOCTYPE html>
<html style="display: none;" lang="en">
    <head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.4.0 -->
    <script>window.materialVersion = "1.4.0"</script>

    <!-- Title -->
    
    <title>
        
            逆向之旅-----找main函数 | 
        
        invisible
    </title>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    
    
    
    
    
    
    
    
    
    

    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="invisible">
    <meta name="description" itemprop="description" content="">
    <meta name="keywords" content="null">

    <!-- Site Verification -->
    
    

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!--iOS -->
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="invisible">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://InvisibleLeVen.github.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="逆向之旅-----找main函数 | invisible">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content="">
    

    
        <meta property="article:published_time" content="Jan 12, 2018">
        <meta property="article:modified_time" content="Jan 12, 2018">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:title" content="逆向之旅-----找main函数 | invisible">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="/img/favicon.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://InvisibleLeVen.github.io">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="https://InvisibleLeVen.github.io/2018/01/12/hello-world/index.html">
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "invisible",
        "logo": "/img/favicon.png"
    },
    "author": {
        "@type": "Person",
        "name": "invisible",
        "image": {
            "@type": "ImageObject",
            "url": "/img/favicon.png"
        },
        "description": "Success is going from failure to failure without losing enthusiasm"
    },
    "headline": "逆向之旅-----找main函数",
    "url": "https://InvisibleLeVen.github.io/2018/01/12/hello-world/index.html",
    "datePublished": "Jan 12, 2018",
    "dateModified": "Jan 12, 2018",
    "description": "",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://InvisibleLeVen.github.io"
    }
}
</script>


    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.en.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(key){try{localStorage.removeItem(key)}catch(e){}};lsloader.setLS=function(key,val){try{localStorage.setItem(key,val)}catch(e){}};lsloader.getLS=function(key){var val="";try{val=localStorage.getItem(key)}catch(e){val=""}return val};versionString="/*"+materialVersion+"*/";lsloader.clean=function(){try{var keys=[];for(var i=0;i<localStorage.length;i++){keys.push(localStorage.key(i))}keys.forEach(function(key){var data=lsloader.getLS(key);if(data&&data.indexOf(versionString)===-1){lsloader.removeLS(key)}})}catch(e){}};lsloader.clean();lsloader.load=function(jsname,jspath,cssonload){cssonload=cssonload||function(){};var code;code=this.getLS(jsname);if(code&&code.indexOf(versionString)===-1){this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload);return}if(code){var versionNumber=code.split(versionString)[0];if(versionNumber!=jspath){console.log("reload:"+jspath);this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload);return}code=code.split(versionString)[1];if(/\.js?.+$/.test(versionNumber)){this.jsRunSequence.push({name:jsname,code:code});this.runjs(jspath,jsname,code)}else{document.getElementById(jsname).appendChild(document.createTextNode(code));cssonload()}}else{this.requestResource(jsname,jspath,cssonload)}};lsloader.requestResource=function(name,path,cssonload){var that=this;if(/\.js?.+$/.test(path)){this.iojs(path,name,function(path,name,code){that.setLS(name,path+versionString+code);that.runjs(path,name,code)})}else if(/\.css?.+$/.test(path)){this.iocss(path,name,function(code){document.getElementById(name).appendChild(document.createTextNode(code));that.setLS(name,path+versionString+code)},cssonload)}};lsloader.iojs=function(path,jsname,callback){var that=this;that.jsRunSequence.push({name:jsname,code:""});try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(path,jsname,xhr.response);return}}that.jsfallback(path,jsname)}};xhr.send(null)}catch(e){that.jsfallback(path,jsname)}};lsloader.iocss=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.iofonts=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.runjs=function(path,name,code){if(!!name&&!!code){for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code=code}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var script=document.createElement("script");script.appendChild(document.createTextNode(this.jsRunSequence[0].code));script.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(script);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var that=this;var script=document.createElement("script");script.src=this.jsRunSequence[0].path;script.type="text/javascript";this.jsRunSequence[0].status="loading";script.onload=function(){that.jsRunSequence.shift();if(that.jsRunSequence.length>0){that.runjs()}};document.body.appendChild(script)}};lsloader.tagLoad=function(path,name){this.jsRunSequence.push({name:name,code:"",path:path,status:"failed"});this.runjs()};lsloader.jsfallback=function(path,name){if(!!this.jsnamemap[name]){return}else{this.jsnamemap[name]=name}for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code="";this.jsRunSequence[k].status="failed";this.jsRunSequence[k].path=path}}this.runjs()};lsloader.cssfallback=function(path,name,cssonload){if(!!this.cssnamemap[name]){return}else{this.cssnamemap[name]=1}var link=document.createElement("link");link.type="text/css";link.href=path;link.rel="stylesheet";link.onload=link.onerror=cssonload;var root=document.getElementsByTagName("script")[0];root.parentNode.insertBefore(link,root)};lsloader.runInlineScript=function(scriptId,codeId){var code=document.getElementById(codeId).innerText;this.jsRunSequence.push({name:scriptId,code:code});this.runjs()};lsloader.loadCombo=function(jslist){var updateList="";var requestingModules={};for(var k in jslist){var LS=this.getLS(jslist[k].name);if(!!LS){var version=LS.split(versionString)[0];var code=LS.split(versionString)[1]}else{var version=""}if(version==jslist[k].path){this.jsRunSequence.push({name:jslist[k].name,code:code,path:jslist[k].path})}else{this.jsRunSequence.push({name:jslist[k].name,code:null,path:jslist[k].path,status:"comboloading"});requestingModules[jslist[k].name]=true;updateList+=(updateList==""?"":";")+jslist[k].path}}var that=this;if(!!updateList){var xhr=new XMLHttpRequest;xhr.open("get",combo+updateList,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){that.runCombo(xhr.response,requestingModules);return}}else{for(var i in that.jsRunSequence){if(requestingModules[that.jsRunSequence[i].name]){that.jsRunSequence[i].status="failed"}}that.runjs()}}};xhr.send(null)}this.runjs()};lsloader.runCombo=function(comboCode,requestingModules){comboCode=comboCode.split("/*combojs*/");comboCode.shift();for(var k in this.jsRunSequence){if(!!requestingModules[this.jsRunSequence[k].name]&&!!comboCode[0]){this.jsRunSequence[k].status="comboJS";this.jsRunSequence[k].code=comboCode[0];this.setLS(this.jsRunSequence[k].name,this.jsRunSequence[k].path+versionString+comboCode[0]);comboCode.shift()}}this.runjs()}})();</script>

    <!-- Import CSS & jQuery -->
    
        <style id="css/material.min.css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("css/material.min.css","/css/material.min.css?fJTiM/K1J3dWIruo3pxtAw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";})</script>
        <style id="css/style.min.css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("css/style.min.css","/css/style.min.css?oCSEO3ST+aEypEwttTDI9g==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";})</script>
        
        
            <style>
    
    .footer-sns-facebook {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik0xMzguNiA3OGMtMjIuNCA1LjItNTUuOCA0MC4yLTYwLjYgNjMuNC0xLjQgNi40LTIgMTI5LjgtMS42IDM2Ny42LjYgMjk4LjYgMSAzNTguOCAzLjQgMzYzIDExIDIwLjIgMjEuNiAzMi40IDM3LjIgNDMgMTUgMTAuMiAxNy40IDExLjIgMzMgMTMgMTEuMiAxLjQgMTM2IDIgMzY1IDEuNiAzMTQtLjYgMzQ4LjYtMSAzNTUtMy44IDE1LjgtNy4yIDMzLjgtMjIgNDMuMi0zNS40IDUuMi03LjQgMTAuOC0xNi42IDEyLjYtMjAuNCAyLjgtNi40IDMuMi00MC44IDMuOC0zNTQgLjQtMjIzLS4yLTM1My40LTEuNC0zNjUtMi0xNy0yLjYtMTguNi0xMy0zNC04LjYtMTIuNi0xNC4yLTE4LjQtMjUuMi0yNS44LTcuOC01LjQtMTcuNC0xMS0yMS42LTEyLjQtNi0yLjItNzIuOC0yLjYtMzY1LjQtMi42LTE5Ni44LjItMzYxIC44LTM2NC40IDEuOHptNjU3LjYgODcuOGw0LjggMy44djU1LjJjMCA1NC42IDAgNTUuMi00LjYgNTkuNi00LjQgNC40LTYgNC42LTUwLjIgNS42bC00NS42IDEtNy4yIDUuNmMtMTAuNCA4LTE2LjggMTcuMi0xOS4yIDI3LjQtMSA1LTEuOCAyNC44LTEuOCA0NCAuMiAzOCAxLjYgNDQuNiAxMC44IDQ4IDIuOCAxLjIgMjguNCAyIDU2LjggMiA0Ny44IDAgNTIgLjIgNTYuMiAzLjhsNC44IDMuOHY1NS4yYzAgNTQuNiAwIDU1LjItNC42IDU5LjYtNC40IDQuNi01LjQgNC42LTU3IDUuMi0yOC44LjItNTQuNC44LTU2LjggMS40LTIuNC42LTUuNiAzLTYuOCA1LjQtMS44IDMuMi0yLjQgNDEuNC0yLjYgMTQzLjJsLS4yIDEzOC44LTUuNiA0LjgtNS42IDQuOEg2MDljLTUyLjQgMC01Mi44IDAtNTguMi00LjZsLTUuNC00LjYtLjItMTQwLjYtLjItMTQwLjYtNC44LTMuOGMtNC4yLTMuNC04LTMuOC0zNS42LTMuOC0zMi44IDAtNDEtMS44LTQzLjYtMTAtLjYtMi4yLTEuMi0yNS40LTEuMi01MS40IDAtNjAuOC0uMi01NyAzLjQtNjEuNiAyLjgtMy42IDYtNCAzNy44LTUgMzMtMSAzNS4yLTEuMiAzOS40LTUuNiA0LjYtNC40IDQuNi01LjIgNS44LTcxIDEuMi03My40LjItNjcuMiAxNi42LTk5LjQgOC0xNS44IDEyLjgtMjIgMjgtMzcgMTUuMi0xNS4yIDIxLjQtMTkuNiAzOC4yLTI4IDExLTUuNCAyNC0xMSAyOS0xMi4yIDYuMi0xLjggMjguNi0yLjYgNzEuMi0yLjYgNTguNi0uMiA2Mi42IDAgNjcgMy42eiIvPjwvc3ZnPg==);
    }
    
    
    .footer-sns-twitter {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik0xMzguNiA3OGMtMjIuNCA1LjItNTUuOCA0MC4yLTYwLjYgNjMuNC0xLjQgNi40LTIgMTI5LjgtMS42IDM2Ny42LjYgMjk4LjYgMSAzNTguOCAzLjQgMzYzIDExIDIwLjIgMjEuNiAzMi40IDM3LjIgNDMgMTUgMTAuMiAxNy40IDExLjIgMzMgMTMgMTEuMiAxLjQgMTM2IDIgMzY1IDEuNiAzMTQtLjYgMzQ4LjYtMSAzNTUtMy44IDE1LjgtNy4yIDMzLjgtMjIgNDMuMi0zNS40IDUuMi03LjQgMTAuOC0xNi42IDEyLjYtMjAuNCAyLjgtNi40IDMuMi00MC44IDMuOC0zNTQgLjQtMjIzLS4yLTM1My40LTEuNC0zNjUtMi0xNy0yLjYtMTguNi0xMy0zNC04LjYtMTIuNi0xNC4yLTE4LjQtMjUuMi0yNS44LTcuOC01LjQtMTcuNC0xMS0yMS42LTEyLjQtNi0yLjItNzIuOC0yLjYtMzY1LjQtMi42LTE5Ni44LjItMzYxIC44LTM2NC40IDEuOHptNTMyLjggMjA1YzEwIDQgMjMgMTAuOCAyOC44IDE1LjIgMTIuNiA5LjIgMTYuNiAxMC42IDI5LjQgOS40IDYuNi0uNiAxMy0zLjIgMjAuNC04LjIgMTEuMi03LjYgMTkuNC05LjIgMjMuNi01IDMuNiAzLjYgMi44IDktMi44IDE4LjYtNy4yIDEyLjQtNiAxOC44IDQuMiAyNC4yIDQuNCAyLjIgOC4yIDUuNiA4LjYgNy40IDEgNC44LTEyLjYgMjQuMi0yMiAzMS44LTExLjggOS4yLTE3LjIgMjIuNi0xOS42IDQ3LjgtNC44IDUwLjQtNy44IDY2LjYtMTYuNCA4NS40LTMgNy03IDE3LjgtOC44IDI0LTEuOCA2LjQtNSAxNC42LTcuNCAxOC40LTIuMiAzLjgtNy40IDEzLTExLjQgMjAuNC0xNy4yIDMwLjgtNDMuNCA2MS40LTcxLjQgODMuOC0yNS42IDIwLjQtNDYgMzMuMi02NC4yIDQwLjItOC40IDMuMi0xOCA3LjYtMjEuNCA5LjYtNy40IDQuNi0yMi40IDguNi01Ny4yIDE1LTYyLjIgMTEuNi03OS4yIDExLjQtMTM1LjYtMS0zMi40LTctMzguNi05LTUyLTE2LjgtMjEuNC0xMi42LTI0LjItMTQuOC0yNC4yLTE5LjQgMC02LjIgMTAuMi05LjIgMzUtMTAuNCAyMi40LTEgMjguNi0yLjYgNTctMTQuMiAyMy44LTkuOCAyOS40LTEyLjggMzAuNC0xNi44IDIuMi04LjItMy0xMy4yLTI2LjgtMjUuNC0yNS44LTEzLjItMzIuMi0xOC40LTQzLjgtMzUuOC05LTEzLjYtMTAtMjEuMi0zLjYtMzMuNiA1LjQtMTAuOCAzLjYtMTUtMTEuOC0yNS40LTktNi0xNC0xMS42LTIwLjgtMjIuNi0yMy40LTM3LjgtMjUtNTAuOC03LjItNTkuOCA0LjgtMi40IDkuNC01LjQgMTAuMi02LjYgMi44LTQuMi0uNC0xNS42LTguNC0yOS0xMS42LTE5LjYtMTMuMi0yNS44LTEzLjItNTUuMiAwLTI4LjggMi42LTM3LjggMTItNDAuMiA5LTIuMiAxNC44IDEgMzUuNiAyMC4yIDI0LjggMjIuOCA0My42IDM2LjYgNjIuOCA0NS44IDggMy44IDE3LjggOS4yIDIyIDEyIDQuMiAyLjggMTQuOCA3IDIzLjQgOS4yIDguNiAyLjIgMjQuMiA2LjggMzQuOCAxMC4yIDEzLjQgNC40IDIzLjYgNi40IDMzIDYuNiAxMi44LjIgMTQuMi0uMiAxOC42LTUuNCA0LTQuOCA0LjgtNy44IDQuOC0xOS4yIDAtMTQuNCA1LjYtMzkuNiAxMS4yLTUwLjYgNC4yLTguNCAyOS4yLTM0LjIgMzkuOC00MS40IDcuOC01LjQgMzUuNi0xNiA1Mi0yMCAxNC4yLTMuNiAzMi42LTEuMiA1Mi40IDYuOHoiLz48L3N2Zz4=);
    }
    
    
    .footer-sns-gplus {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik0xMzguNiA3OGMtMjIuNCA1LjItNTUuOCA0MC4yLTYwLjYgNjMuNC0xLjQgNi40LTIgMTI5LjgtMS42IDM2Ny42LjYgMjk4LjYgMSAzNTguOCAzLjQgMzYzIDExIDIwLjIgMjEuNiAzMi40IDM3LjIgNDMgMTUgMTAuMiAxNy40IDExLjIgMzMgMTMgMTEuMiAxLjQgMTM2IDIgMzY1IDEuNiAzMTQtLjYgMzQ4LjYtMSAzNTUtMy44IDE1LjgtNy4yIDMzLjgtMjIgNDMuMi0zNS40IDUuMi03LjQgMTAuOC0xNi42IDEyLjYtMjAuNCAyLjgtNi40IDMuMi00MC44IDMuOC0zNTQgLjQtMjIzLS4yLTM1My40LTEuNC0zNjUtMi0xNy0yLjYtMTguNi0xMy0zNC04LjYtMTIuNi0xNC4yLTE4LjQtMjUuMi0yNS44LTcuOC01LjQtMTcuNC0xMS0yMS42LTEyLjQtNi0yLjItNzIuOC0yLjYtMzY1LjQtMi42LTE5Ni44LjItMzYxIC44LTM2NC40IDEuOHpNNDMwIDI5NS40YzQwLjYgMTUuNCA1Ni42IDIzLjggNzIuNiAzOC40IDYuOCA2LjIgNy4yIDE1LjIgMSAyMy40LTYuMiA4LTMzLjYgMzMuOC0zOSAzNi42LTUuNiAyLjgtMTcuNiAyLjgtMjMuMi0uMi0yLjQtMS4yLTguMi01LjItMTMtOC44LTExLjItOC42LTI0LjYtMTEuMi01NS4yLTExLjItMjcuNCAwLTQwLjYgMi42LTUyLjIgMTAuNC00LjQgMi44LTEyLjIgNy42LTE3LjIgMTAuNi0yMyAxMy4yLTUxLjQgNTUtNTUuOCA4Mi40LTIuNiAxNS42LTIuNCAzNC44LjIgNTEgMi44IDE3LjQgMTkuOCA0OC44IDM1LjIgNjUuMiAxNiAxNi42IDQ1IDMzLjYgNjIuOCAzNi42IDI2LjggNC40IDY1LjggMS42IDc5LjQtNS44IDIwLjYtMTEuNCAzMS0xOSA0MS0zMC40IDE4LjgtMjEuNiAyMy40LTM0LjIgMTUuNi00My44LTMuOC00LjgtNC40LTQuOC01MS01LjgtNjAuOC0xLjItNTYuMiAyLjItNTYuMi00My4yIDAtMzIuNC4yLTMzLjIgNC44LTM3IDQuNC0zLjYgOS0zLjggOTItMy44IDc5IDAgODcuOC40IDk0LjIgMy42IDExLjIgNS42IDEzIDExLjQgMTIuOCA0My40IDAgMjUuNC0uOCAzMC44LTcuNiA1OC00IDE2LjYtOS44IDM0LTEyLjYgMzktMi44IDUtOC4yIDE0LjItMTEuNiAyMC42LTguNCAxNS40LTI3LjIgMzYuOC00MC44IDQ2LjYtNS44IDQuNC0xMy44IDEwLjItMTcuNiAxMy4yLTMuOCAzLTExIDctMTYuMiA4LjgtNS4yIDEuOC0xNi4yIDYuNC0yNC40IDEwLTIyLjQgOS42LTM0LjggMTEuNi03MyAxMS42LTM3LjYuMi00Ny0xLjQtNzEtMTItOC4yLTMuNi0xNy42LTcuMi0yMC44LTgtMTUuOC0zLjgtNjctNDUuMi03Ny44LTYyLjgtMi4yLTMuOC03LjYtMTEuNi0xMS44LTE3LjItNC4yLTUuNC05LTE0LTEwLjYtMTktMS44LTQuOC02LjItMTYtMTAtMjQuOC0zLjYtOC44LTcuOC0yMi4yLTkuMi0yOS42LTMuMi0xOC44LTEuNC03OS40IDIuOC05MS40IDEzLjgtNDAuNiAzNS42LTc4IDU4LjgtMTAwLjIgMTQtMTMuNiA0Ny4yLTM2LjQgNTgtMzkuOCA0LjItMS40IDEzLjQtNS4yIDIwLjYtOC40IDIyLTEwIDMyLjgtMTEuNiA3Ni0xMSAzMy44LjYgNDAuNCAxLjIgNTAgNC44em0zNDAuOCA4MC44YzggMy42IDkuNiAxMS4yIDkuMiAzOS4yLS42IDM0LjQtLjYgMzQgNSAzOS42IDQuOCA1IDUuNCA1IDM3LjYgNSA0My40IDAgNDQuNC44IDQzLjIgMzYuMi0uOCAxNy0xLjIgMTguNC02LjQgMjMtNS40IDQuNi02LjYgNC44LTM3LjYgNC44LTMxLjIgMC0zMiAuMi0zNi44IDUtNS42IDUuNC01LjYgNC40LTUgNDEuMi40IDI2LjQuMiAyNy40LTQuNiAzMy00LjggNS42LTYgNS44LTI0LjQgNi40LTIwLjguOC0yOS42LTEuNC0zMy40LTguNC0xLjQtMi42LTItMTUuNi0xLjgtMzUuNi40LTMxLjIuNC0zMS42LTQuNi0zNi42cy01LjYtNS0zNi01Yy0xOC44IDAtMzMtLjgtMzYtMi4yLTcuNi0zLjYtOS42LTExLjItOC44LTMzLjguOC0yOC4yLjQtMjggNDEtMjggNDUuNCAwIDQ1LjQgMCA0NC42LTQyLjYtLjYtMzMtLjYtMzMgNS0zOC40IDQuNC00LjYgNi4yLTUgMjQuOC01IDExIDAgMjIuMiAxIDI1IDIuMnoiLz48L3N2Zz4=);
    }
    
    
    
    
    
    
    
    
    
</style>

        
        <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-image: url(/img/bg.png);
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">


        <script>lsloader.load("js/jquery.min.js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==")</script>
    
    
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Analytics -->
    

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn" class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    
    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        
        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>
    





<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                逆向之旅-----找main函数
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar">
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>invisible</strong>
        <span>Jan 12, 2018</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        
    </li></ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=逆向之旅-----找main函数&url=https://InvisibleLeVen.github.io/2018/01/12/hello-world/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                Share to Weibo
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=逆向之旅-----找main函数&url=https://InvisibleLeVen.github.io/2018/01/12/hello-world/index.html&via=invisible" target="_blank">
            <li class="mdl-menu__item">
                Share to Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://InvisibleLeVen.github.io/2018/01/12/hello-world/index.html" target="_blank">
            <li class="mdl-menu__item">
                Share to Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://InvisibleLeVen.github.io/2018/01/12/hello-world/index.html" target="_blank">
            <li class="mdl-menu__item">
                Share to Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>emm.首先看了一篇博客，找main函数的地址，那篇博客里的ida的start函数里直接是很多<br>初始化环境啊..GetCommandLine和和GetEnvironmentStringsA之类的<br>然后下面就直接调用main了，wa。。。。好容易啊可能是VC或者gcc编译出来的吧<br>代码如下<br>void __cdecl start()<br>{<br>  DWORD v0; // eax@1<br>  int v1; // eax@4</p>
<p>  v0 = GetVersion();<br>  dword_4101A4 = BYTE1(v0);<br>  dword_4101A0 = v0;<br>  dword_41019C = BYTE1(v0) + (v0 &lt;&lt; 8);<br>  dword_410198 = v0 &gt;&gt; 16;<br>  if ( !sub_4068EE(0) )<br>    fast_error_exit(0x1Cu);<br>  _ioinit();<br>  dword_411704 = <em>GetCommandLineA</em>();<br>  dword_41017C = __crtGetEnvironmentStringsA();<br>  _setargv();<br>  _setenvp();<br>  _cinit();<br>  dword_4101B8 = envp;<br>  v1 = main(argc, argv, envp);<br>  exit(v1);<br>}<br>容易吧，都是显而易见的东西，然而我用的是vs2015…<br>光栈回溯就起码有5个函数之多<br>于是我把一个简单的helloworld程序放在ida里分析，是这样的<br>int start()<br>{<br>  return start_0();<br>}<br>天壤之别啊…然后我继续跟进<br>int start_0()<br>{<br>  return sub_411C20();<br>}<br>然后又调用了一个函数，接着跟<br>int sub_411C20()<br>{<br>  sub_4111F4();<br>  return sub_411C40();<br>}<br>出现了两个分支，首先点开第一个分支<br>unsigned int sub_4111F4(void)<br>{<br>  return sub_413230();<br>}<br>继续<br>unsigned int sub_413230()<br>{<br>  unsigned int result; // eax@2<br>  LARGE_INTEGER PerformanceCount; // [sp+0h] [bp-14h]@4<br>  struct _FILETIME SystemTimeAsFileTime; // [sp+8h] [bp-Ch]@1<br>  DWORD v3; // [sp+10h] [bp-4h]@4</p>
<p>  SystemTimeAsFileTime.dwLowDateTime = 0;<br>  SystemTimeAsFileTime.dwHighDateTime = 0;<br>  if ( <strong>security_cookie != -1153374642 &amp;&amp; (result = </strong>security_cookie &amp; 0xFFFF0000) != 0 )<br>  {<br>    dword_418024 = ~<strong>security_cookie;<br>  }<br>  else<br>  {<br>    GetSystemTimeAsFileTime(&amp;SystemTimeAsFileTime);<br>    v3 = SystemTimeAsFileTime.dwHighDateTime ^ SystemTimeAsFileTime.dwLowDateTime;<br>    v3 ^= GetCurrentThreadId();<br>    v3 ^= GetCurrentProcessId();<br>    QueryPerformanceCounter(&amp;PerformanceCount);<br>    v3 ^= PerformanceCount.LowPart;<br>    v3 ^= PerformanceCount.HighPart;<br>    v3 ^= (unsigned int)&v3;<br>    if ( v3 == -1153374642 )<br>    {<br>      v3 = -1153374641;<br>    }<br>    else if ( !(v3 &amp; 0xFFFF0000) )<br>    {<br>      v3 |= (v3 | 0x4711) &lt;&lt; 16;<br>    }<br>    result = v3;
    </strong>security_cookie = v3;<br>    dword_418024 = ~v3;<br>  }<br>  return result;<br>}<br>发现了这堆东西，大概和线程和编译器初始化还有文件时间security_cookie之类的东西有关，不管了，这里主要任务是寻找main<br>发现这里并没有出现main函数，和调用其他函数，那么main的调用一定在另一个函数里面了<br>sub_411C40<br>跟进却发现了一个问题<br>f5的时候出现sp-analysis failed 的错误…google一下。发现在ida官网有很多可能性导致这种情况的产生..<br>至少20种以上吧…<br>地址是<a href="https://www.hex-rays.com/products/decompiler/manual/failures.shtml" target="_blank" rel="noopener">https://www.hex-rays.com/products/decompiler/manual/failures.shtml</a><br>猜测可能是微软开发人员想增加逆向工作者的难度故意写了一些骚操作吧..<br>不能f5那么我们只能去看汇编指令寻找main了<br>首先找到那个sub_411C40这个函数的地址，ida自带有字符串搜索功能—在ida右上角<br>.text:00411C40<br>.text:00411C40 ; =============== S U B R O U T I N E =======================================<br>.text:00411C40<br>.text:00411C40 ; Attributes: bp-based frame<br>.text:00411C40<br>.text:00411C40 sub_411C40      proc near               ; CODE XREF: sub_411C20+8p<br>.text:00411C40<br>.text:00411C40 var_40          = dword ptr -40h<br>.text:00411C40 var_3C          = dword ptr -3Ch<br>.text:00411C40 var_38          = dword ptr -38h<br>.text:00411C40 var_34          = dword ptr -34h<br>.text:00411C40 var_30          = dword ptr -30h<br>.text:00411C40 Code            = dword ptr -2Ch<br>.text:00411C40 var_28          = dword ptr -28h<br>.text:00411C40 var_24          = dword ptr -24h<br>.text:00411C40 var_20          = dword ptr -20h<br>.text:00411C40 var_1A          = byte ptr -1Ah<br>.text:00411C40 var_19          = byte ptr -19h<br>.text:00411C40 ms_exc          = CPPEH_RECORD ptr -18h<br>.text:00411C40<br>.text:00411C40                 push    ebp             ; 这个函数做初始化工作，下面调用一个函数，得到环境变量和参数<br>.text:00411C41                 mov     ebp, esp<br>.text:00411C43                 push    0FFFFFFFEh<br>.text:00411C45                 push    offset stru_417E48<br>.text:00411C4A                 push    offset sub_413900<br>.text:00411C4F                 mov     eax, large fs:0<br>.text:00411C55                 push    eax<br>.text:00411C56                 add     esp, 0FFFFFFD0h<br>.text:00411C59                 push    ebx<br>.text:00411C5A                 push    esi<br>.text:00411C5B                 push    edi<br>.text:00411C5C                 mov     eax, <strong>_security_cookie<br>.text:00411C61                 xor     [ebp+ms_exc.registration.ScopeTable], eax<br>.text:00411C64                 xor     eax, ebp<br>.text:00411C66                 push    eax<br>.text:00411C67                 lea     eax, [ebp+ms_exc.registration]<br>.text:00411C6A                 mov     large fs:0, eax<br>.text:00411C70                 mov     [ebp+ms_exc.old_esp], esp<br>.text:00411C73                 push    1<br>.text:00411C75                 call    sub_41127B<br>.text:00411C7A                 add     esp, 4<br>.text:00411C7D                 movzx   eax, al<br>.text:00411C80                 test    eax, eax<br>.text:00411C82                 jnz     short loc_411C8B<br>.text:00411C84                 push    7<br>.text:00411C86                 call    sub_41105A<br>.text:00411C8B<br>.text:00411C8B loc_411C8B:                             ; CODE XREF: sub_411C40+42j<br>.text:00411C8B                 mov     [ebp+var_19], 0<br>.text:00411C8F                 mov     [ebp+ms_exc.registration.TryLevel], 0<br>.text:00411C96                 call    sub_41130C<br>.text:00411C9B                 mov     [ebp+var_1A], al<br>.text:00411C9E                 cmp     dword_418160, 1<br>.text:00411CA5                 jnz     short loc_411CB0<br>.text:00411CA7                 push    7<br>.text:00411CA9                 call    sub_41105A<br>.text:00411CAE                 jmp     short loc_411D11<br>.text:00411CB0 ; —————————————————————————<br>.text:00411CB0<br>.text:00411CB0 loc_411CB0:                             ; CODE XREF: sub_411C40+65j<br>.text:00411CB0                 cmp     dword_418160, 0<br>.text:00411CB7                 jnz     short loc_411D0D<br>.text:00411CB9                 mov     dword_418160, 1<br>.text:00411CC3                 push    offset unk_416618<br>.text:00411CC8                 push    offset unk_41630C<br>.text:00411CCD                 call    j</strong>initterm_e<br>.text:00411CD2                 add     esp, 8<br>.text:00411CD5                 test    eax, eax<br>.text:00411CD7                 jz      short loc_411CEF<br>.text:00411CD9                 mov     [ebp+var_38], 0FFh<br>.text:00411CE0                 mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh<br>.text:00411CE7                 mov     eax, [ebp+var_38]<br>.text:00411CEA                 jmp     loc_411E3B<br>.text:00411CEF ; —————————————————————————<br>.text:00411CEF<br>.text:00411CEF loc_411CEF:                             ; CODE XREF: sub_411C40+97j<br>.text:00411CEF                 push    offset unk_416208<br>.text:00411CF4                 push    offset unk_416000<br>.text:00411CF9                 call    j__initterm<br>.text:00411CFE                 add     esp, 8<br>.text:00411D01                 mov     dword_418160, 2<br>.text:00411D0B                 jmp     short loc_411D11<br>.text:00411D0D ; —————————————————————————<br>.text:00411D0D<br>.text:00411D0D loc_411D0D:                             ; CODE XREF: sub_411C40+77j<br>.text:00411D0D                 mov     [ebp+var_19], 1<br>.text:00411D11<br>.text:00411D11 loc_411D11:                             ; CODE XREF: sub_411C40+6Ej<br>.text:00411D11                                         ; sub_411C40+CBj<br>.text:00411D11                 movzx   ecx, [ebp+var_1A]<br>.text:00411D15                 push    ecx<br>.text:00411D16                 call    sub_411302<br>.text:00411D1B                 add     esp, 4<br>.text:00411D1E                 call    sub_411271<br>.text:00411D23                 mov     [ebp+var_20], eax<br>.text:00411D26                 mov     edx, [ebp+var_20]<br>.text:00411D29                 cmp     dword ptr [edx], 0<br>.text:00411D2C                 jz      short loc_411D5A<br>.text:00411D2E                 mov     eax, [ebp+var_20]<br>.text:00411D31                 push    eax<br>.text:00411D32                 call    sub_411348<br>.text:00411D37                 add     esp, 4<br>.text:00411D3A                 movzx   ecx, al<br>.text:00411D3D                 test    ecx, ecx<br>.text:00411D3F                 jz      short loc_411D5A<br>.text:00411D41                 push    0<br>.text:00411D43                 push    2<br>.text:00411D45                 push    0<br>.text:00411D47                 mov     edx, [ebp+var_20]<br>.text:00411D4A                 mov     eax, [edx]<br>.text:00411D4C                 mov     [ebp+var_28], eax<br>.text:00411D4F                 mov     ecx, [ebp+var_28]<br>.text:00411D52                 call    sub_4112BC<br>.text:00411D57                 call    [ebp+var_28]<br>.text:00411D5A<br>.text:00411D5A loc_411D5A:                             ; CODE XREF: sub_411C40+ECj<br>.text:00411D5A                                         ; sub_411C40+FFj<br>.text:00411D5A                 call    sub_4110C3<br>.text:00411D5F                 mov     [ebp+var_24], eax<br>.text:00411D62                 mov     ecx, [ebp+var_24]<br>.text:00411D65                 cmp     dword ptr [ecx], 0<br>.text:00411D68                 jz      short loc_411D8B<br>.text:00411D6A                 mov     edx, [ebp+var_24]<br>.text:00411D6D                 push    edx<br>.text:00411D6E                 call    sub_411348<br>.text:00411D73                 add     esp, 4<br>.text:00411D76                 movzx   eax, al<br>.text:00411D79                 test    eax, eax<br>.text:00411D7B                 jz      short loc_411D8B<br>.text:00411D7D                 mov     ecx, [ebp+var_24]<br>.text:00411D80                 mov     edx, [ecx]<br>.text:00411D82                 push    edx<br>.text:00411D83                 call    j__register_thread_local_exe_atexit_callback<br>.text:00411D88                 add     esp, 4<br>.text:00411D8B<br>.text:00411D8B loc_411D8B:                             ; CODE XREF: sub_411C40+128j<br>.text:00411D8B                                         ; sub_411C40+13Bj<br>.text:00411D8B                 call    sub_411F10      ; <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>mark<br>.text:00411D90                 mov     [ebp+Code], eax<br>.text:00411D93                 call    sub_41111D<br>.text:00411D98                 movzx   eax, al<br>.text:00411D9B                 test    eax, eax<br>.text:00411D9D                 jnz     short loc_411DA8<br>.text:00411D9F                 mov     ecx, [ebp+Code]<br>.text:00411DA2                 push    ecx             ; Code<br>.text:00411DA3                 call    j_exit<br>.text:00411DA8 ; —————————————————————————<br>.text:00411DA8<br>.text:00411DA8 loc_411DA8:                             ; CODE XREF: sub_411C40+15Dj<br>.text:00411DA8                 movzx   edx, [ebp+var_19]<br>.text:00411DAC                 test    edx, edx<br>.text:00411DAE                 jnz     short loc_411DB5<br>.text:00411DB0                 call    j__cexit<br>.text:00411DB5<br>.text:00411DB5 loc_411DB5:                             ; CODE XREF: sub_411C40+16Ej<br>.text:00411DB5                 push    0<br>.text:00411DB7                 push    1<br>.text:00411DB9                 call    sub_411159<br>.text:00411DBE                 add     esp, 8<br>.text:00411DC1                 mov     eax, [ebp+Code]<br>.text:00411DC4                 mov     [ebp+var_3C], eax<br>.text:00411DC7                 mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh<br>.text:00411DCE                 mov     eax, [ebp+var_3C]<br>.text:00411DD1                 jmp     short loc_411E3B<br>.text:00411DD3 ; —————————————————————————<br>.text:00411DD3                 mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh<br>.text:00411DDA                 jmp     short loc_411E3B<br>.text:00411DDC ; —————————————————————————<br>.text:00411DDC<br>.text:00411DDC loc_411DDC:                             ; DATA XREF: .rdata:stru_417E48o<br>.text:00411DDC                 mov     ecx, [ebp+ms_exc.exc_ptr] ; Exception filter 0 for function 411C40<br>.text:00411DDF                 mov     edx, [ecx]<br>.text:00411DE1                 mov     eax, [edx]<br>.text:00411DE3                 mov     [ebp+var_30], eax<br>.text:00411DE6                 mov     ecx, [ebp+ms_exc.exc_ptr]<br>.text:00411DE9                 push    ecx<br>.text:00411DEA                 mov     edx, [ebp+var_30]<br>.text:00411DED                 push    edx<br>.text:00411DEE                 call    j__seh_filter_exe<br>.text:00411DF3                 add     esp, 8<br>.text:00411DF6                 retn<br>.text:00411DF7 ; —————————————————————————<br>.text:00411DF7<br>.text:00411DF7 loc_411DF7:                             ; DATA XREF: .rdata:stru_417E48o<br>.text:00411DF7                 mov     esp, [ebp+ms_exc.old_esp] ; Exception handler 0 for function 411C40<br>.text:00411DFA                 mov     eax, [ebp+var_30]<br>.text:00411DFD                 mov     [ebp+var_34], eax<br>.text:00411E00                 call    sub_41111D<br>.text:00411E05                 movzx   ecx, al<br>.text:00411E08                 test    ecx, ecx<br>.text:00411E0A                 jnz     short loc_411E15<br>.text:00411E0C                 mov     edx, [ebp+var_34]<br>.text:00411E0F                 push    edx             ; Code<br>.text:00411E10                 call    j__exit<br>.text:00411E15 ; —————————————————————————<br>.text:00411E15<br>.text:00411E15 loc_411E15:                             ; CODE XREF: sub_411C40+1CAj<br>.text:00411E15                 movzx   eax, [ebp+var_19]<br>.text:00411E19                 test    eax, eax<br>.text:00411E1B                 jnz     short loc_411E22<br>.text:00411E1D                 call    j__c_exit<br>.text:00411E22<br>.text:00411E22 loc_411E22:                             ; CODE XREF: sub_411C40+1DBj<br>.text:00411E22                 mov     ecx, [ebp+var_34]<br>.text:00411E25                 mov     [ebp+var_40], ecx<br>.text:00411E28                 mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh<br>.text:00411E2F                 mov     eax, [ebp+var_40]<br>.text:00411E32                 jmp     short loc_411E3B<br>.text:00411E34 ; —————————————————————————<br>.text:00411E34                 mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh<br>.text:00411E3B<br>.text:00411E3B loc_411E3B:                             ; CODE XREF: sub_411C40+AAj<br>.text:00411E3B                                         ; sub_411C40+191j …<br>.text:00411E3B                 mov     ecx, [ebp+ms_exc.registration.Next]<br>.text:00411E3E                 mov     large fs:0, ecx<br>.text:00411E45                 pop     ecx<br>.text:00411E46                 pop     edi<br>.text:00411E47                 pop     esi<br>.text:00411E48                 pop     ebx<br>.text:00411E49                 mov     esp, ebp<br>.text:00411E4B                 pop     ebp<br>.text:00411E4C                 retn<br>.text:00411E4C sub_411C40      endp ; sp-analysis failed<br>emm大概就是这段，，有点长，<br>如果你想从上面一路往下找call也不是不可以<br>但是我是逆着来的。首先找到ida左边那一堆函数，找到和argc和argv有关的函数<br>我们可以双击到那个函数的地址<br>.text:00414BE2 <strong>p_</strong>argc      proc near               ; CODE XREF: j___p___argcj<br>.text:00414BE2                 jmp     ds:<strong>imp_</strong>p___argc<br>.text:00414BE2 <strong>p_</strong>argc      endp<br>呐这是argc的，然后根据这个地址，也就是00414BE2<br>找到哪个函数调用过他–我用的是万能的搜索字符串大法<br>.text:00411F10 sub_411F10      proc near               ; CODE XREF: sub_411C40:loc_411D8Bp<br>.text:00411F10                 push    ebp<br>.text:00411F11                 mov     ebp, esp<br>.text:00411F13                 call    j__get_initial_narrow_environment<br>.text:00411F18                 push    eax<br>.text:00411F19                 call    j___p___argv<br>.text:00411F1E                 mov     eax, [eax]<br>.text:00411F20                 push    eax<br>.text:00411F21                 call    j___p___argc<br>.text:00411F26                 mov     ecx, [eax]<br>.text:00411F28                 push    ecx<br>.text:00411F29                 call    sub_411294<br>.text:00411F2E                 add     esp, 0Ch<br>.text:00411F31                 pop     ebp<br>.text:00411F32                 retn<br>.text:00411F32 sub_411F10      endp<br>发现这个函数调用了argv和argc还有j__get_initial_narrow_environment<br>这个类似与GetEnvironmentStringsA的函数<br>还有三个push，那么毋庸置疑，下面那个call sub_411294就是main了<br>我们继续，找到这个函数的地址<br>.text:00411294 sub_411294      proc near               ; CODE XREF: sub_411F10+19p<br>.text:00411294                 jmp     sub_411770      ; invoke_main <strong><strong><strong><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong></strong></strong></strong><br>.text:00411294 sub_411294      endp<br>发现他又调用了一个函数<br>我们继续这个函数就是main函数</p>
<p>.text:00411770<br>.text:00411770 ; =============== S U B R O U T I N E =======================================<br>.text:00411770<br>.text:00411770 ; Attributes: bp-based frame<br>.text:00411770<br>.text:00411770 sub_411770      proc near               ; CODE XREF: sub_411294j<br>.text:00411770<br>.text:00411770 var_C0          = byte ptr -0C0h<br>.text:00411770<br>.text:00411770                 push    ebp             ; main func<strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>finally i find you<br>.text:00411771                 mov     ebp, esp<br>.text:00411773                 sub     esp, 0C0h<br>.text:00411779                 push    ebx<br>.text:0041177A                 push    esi<br>.text:0041177B                 push    edi<br>.text:0041177C                 lea     edi, [ebp+var_C0]<br>.text:00411782                 mov     ecx, 30h<br>.text:00411787                 mov     eax, 0CCCCCCCCh<br>.text:0041178C                 rep stosd<br>.text:0041178E                 push    offset aHelloWorld ; “hello world”<br>.text:00411793                 call    sub_41131B<br>.text:00411798                 add     esp, 4<br>.text:0041179B                 mov     esi, esp<br>.text:0041179D                 push    offset Command  ; “pause”<br>.text:004117A2                 call    ds:system<br>.text:004117A8                 add     esp, 4<br>.text:004117AB                 cmp     esi, esp<br>.text:004117AD                 call    sub_411113<br>.text:004117B2                 xor     eax, eax<br>.text:004117B4                 pop     edi<br>.text:004117B5                 pop     esi<br>.text:004117B6                 pop     ebx<br>.text:004117B7                 add     esp, 0C0h<br>.text:004117BD                 cmp     ebp, esp<br>.text:004117BF                 call    sub_411113<br>.text:004117C4                 mov     esp, ebp<br>.text:004117C6                 pop     ebp<br>.text:004117C7                 retn<br>.text:004117C7 sub_411770      endp<br>哈哈，输出hello world<br>其实上面那个函数调用的是invoke_main<br>通过打印出vs2015的栈回溯就知道了</p>
<p>main   addr:  012FFB3C<br>main, d:\play\c++\c++\源.cp, line 111<br>invoke_main   addr:  012FFB40<br>invoke_main, f:\dd\vctools\crt\vcstartup\src\startup\exe_common.inl, line 64<br><strong>scrt_common_main_seh   addr:  012FFB44
</strong>scrt_common_main_seh, f:\dd\vctools\crt\vcstartup\src\startup\exe_common.inl, line 253<br><strong>scrt_common_main   addr:  012FFB48
</strong>scrt_common_main, f:\dd\vctools\crt\vcstartup\src\startup\exe_common.inl, line 296<br>mainCRTStartup   addr:  012FFB4C<br>mainCRTStartup, f:\dd\vctools\crt\vcstartup\src\startup\exe_main.cpp, line 17<br>BaseThreadInitThunk   addr:  012FFB50</p>
<p>RtlGetAppContainerNamedObjectPath   addr:  012FFB54</p>
<p>RtlGetAppContainerNamedObjectPath   addr:  012FFB58<br>至于那个之前ida识别不出来的函数也就是<br><strong>scrt_common_main_seh了<br>那么现在来理一下<br>一开始的main也就是BaseThreadInitThunk<br>start_0就是mainCRTStartup<br> sub_411C20就是</strong>scrt_common_main<br>这么一来vs2015的全部调用的函数也就一清二楚了</p>

    

    
</div>


                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2018/01/17/Kali-In-USB/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Newer
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="invisible's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        2224362775@qq.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                Home
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    Archives
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/01/">January 2018<span class="sidebar_archives-count">2</span></a>
            </li></ul>
        </li>
        
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material" class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            Theme - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/twitter" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/facebook" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-facebook">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>invisible
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->


    <script>lsloader.load("js/lazyload.min.js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==")</script>
    <script>lsloader.load("js/js.min.js","/js/js.min.js?oAl/+lvaqTFV31JXTmbrNA==")</script>



    <script>lsloader.load("js/nprogress.js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==")</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>













<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Window Load-->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->

<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Bing Background -->


<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.4.0 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        <script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/chitose.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
    
</html>
